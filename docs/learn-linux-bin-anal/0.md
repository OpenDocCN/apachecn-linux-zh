# 零、前言

软件工程是创造一项在微处理器上存在、存在和呼吸的发明。 我们称之为程序。 逆向工程的行为发现这个项目如何生活和呼吸,而且它是我们如何理解,解剖,或修改的行为程序使用反汇编器和扭转工具和依赖我们的黑客本能掌握我们逆向工程的目标程序。 我们必须理解复杂的二进制格式、内存布局和给定处理器的指令集。 因此，我们成为了赋予微处理器上的程序生命的主人。 逆向工程师擅长二元精通的艺术。 本书将为您提供成为 Linux 二进制黑客所需的适当课程、见解和任务。 当有人可以称自己为逆向工程师时，他们把自己提升到了不仅仅是工程的水平。 真正的黑客不仅会写代码，还会剖析代码，反汇编二进制文件和内存段，以追求修改软件程序的内部工作; 这就是力量……

在专业和业余水平上，我使用我的逆向工程技能在计算机安全领域，无论是漏洞分析，恶意软件分析，杀毒软件，rootkit 检测，或病毒设计。 这本书的大部分内容将集中在计算机安全方面。 我们将分析内存转储，重建进程图像，并探索二进制分析的一些更深奥的领域，包括 Linux 病毒感染和二进制取证。 我们将剖析被恶意软件感染的可执行文件，并感染正在运行的进程。 本书旨在解释在 Linux 中进行逆向工程所必需的组件，因此我们将深入学习 ELF(可执行和链接格式)，它是在 Linux 中用于可执行文件、共享库、核心转储和目标文件的二进制格式。 这本书最重要的方面之一是它对 ELF 二进制格式的结构复杂性进行了深刻的理解。 ELF 部分、片段和动态链接概念是非常重要和令人兴奋的知识块。 我们将深入研究破解 ELF 二进制文件，并了解如何将这些技能应用到广泛的工作中。

这本书的目的是教你是为数不多的几个人在 Linux 二进制程序黑客强有力的基础,将显示作为一个庞大的主题,开门创新研究和让你低级的前沿黑客的 Linux 操作系统。 您将获得 Linux 二进制(和内存)补丁、病毒工程/分析、内核取证和 ELF 二进制格式等方面的宝贵知识。 您还将深入了解程序执行和动态链接，并对二进制保护和内部调试有更高的理解。

我是一名计算机安全研究员、软件工程师和黑客。 这本书仅仅是一个有组织的观察和记录我所做的研究和基础知识，已经证明了作为结果。

这些知识涵盖了互联网上任何一个地方都无法找到的广泛信息。 这本书试图将许多相互关联的主题集中在一起，以便它可以作为一个介绍性手册和参考 Linux 二进制代码和内存破解的主题。 它绝不是一个完整的参考，但确实包含了许多核心信息开始。

# 这本书的内容

第 1 章，*Linux 环境及其工具*简要描述了我们将在整本书中使用的 Linux 环境及其工具。

第二章，*ELF 二进制格式*帮助您了解在 Linux 和大多数 unix 操作系统上使用的 ELF 二进制格式的每个主要组件。

第三章，*Linux 进程跟踪*，教你如何使用 ptrace 系统调用来读写进程内存和注入代码。

[第 4 章](4.html#164MG1-1d4163ae11644cc2802846625b2dc985 "Chapter 4. ELF Virus Technology – Linux/Unix Viruses")，*ELF 病毒技术- Linux/Unix 病毒*，在这里你会发现 Linux 病毒的过去，现在和未来，它们是如何被设计的，以及围绕它们的所有惊人的研究。

第五章，*Linux 二进制保护*，阐述了 ELF 二进制保护的基本内部原理。

[第 6 章](6.html#1P71O2-1d4163ae11644cc2802846625b2dc985 "Chapter 6. ELF Binary Forensics in Linux")，*ELF 二进制取证在 Linux*，是你学习剖析 ELF 对象在搜索病毒，后门，和可疑代码注入。

[第七章](7.html#21PMQ1-1d4163ae11644cc2802846625b2dc985 "Chapter 7. Process Memory Forensics")，*进程内存取证*，展示了如何剖析进程地址空间，以搜索恶意软件，后门，以及可疑的代码注入，这些都存在于内存中。

[第 8 章](8.html#26I9K1-1d4163ae11644cc2802846625b2dc985 "Chapter 8. ECFS – Extended Core File Snapshot Technology")，*ECFS - Extended Core File Snapshot Technology*，介绍了 ECFS，一个新的开源产品，用于深度进程内存取证。

第 9 章，*Linux /proc/kcore 分析*，展示了如何通过/proc/kcore 内存分析来检测 Linux 内核恶意软件。

# 你需要什么来写这本书

这本书的先决条件如下:我们假设你有 Linux 命令行的工作知识，全面的 C 编程技能，以及对 x86 汇编语言的基本掌握(这是有帮助的，但不是必需的)。 有一种说法，“如果你能读懂汇编语言，那么一切都是开源的。”

# 这本书是写给谁的

如果您是一名软件工程师或逆向工程师，并且想要学习更多关于 Linux 二进制分析的知识，这本书将为您提供在安全、取证和反病毒领域实现二进制分析解决方案所需的所有知识。 这本书对于安全爱好者和系统级工程师来说都是极好的。 需要具备 C 编程语言和 Linux 命令行方面的经验。

# 约定

在这本书中，你会发现许多不同的文本样式来区分不同种类的信息。 下面是这些风格的一些例子以及对它们含义的解释。

文本中的代码字、数据库表名、文件夹名、文件名、文件扩展名、路径名、虚拟 url、用户输入和 Twitter 句柄如下所示:“有 7 个 section 头，从偏移量`0x1118`开始。”

一段代码设置如下:

```sh
uint64_t injection_code(void * vaddr)
{
        volatile void *mem;

        mem = evil_mmap(vaddr,
                        8192,
                        PROT_READ|PROT_WRITE|PROT_EXEC,
                        MAP_PRIVATE|MAP_FIXED|MAP_ANONYMOUS,
                        -1, 0);

        __asm__ __volatile__("int3");
}
```

当我们希望提请您注意代码块的特定部分时，相关的行或项以粗体显示:

```sh
0xb755a990] changed to [0x8048376]
[+] Patched GOT with PLT stubs
Successfully rebuilt ELF object from memory
Output executable location: dumpme.out
[Quenya v0.1@ELFWorkshop]
quit
```

任何命令行输入或输出都写如下:

```sh
hacker@ELFWorkshop:~/
workshop/labs/exercise_9$ ./dumpme.out

```

### 注意事项

警告或重要说明显示在这样的框中。

### 提示

提示和技巧是这样的。

# 读者反馈

我们欢迎读者的反馈。 让我们知道你对这本书的看法——你喜欢或不喜欢这本书。 读者反馈对我们来说很重要，因为它能帮助我们开发出你能真正从中获益最多的游戏。

要向我们发送一般性的反馈，只需发送电子邮件`<[feedback@packtpub.com](mailto:feedback@packtpub.com)>`，并在邮件的主题中提到这本书的标题。

如果有一个主题，你有专业知识，你有兴趣写或贡献一本书，请参阅我们的作者指南[www.packtpub.com/authors](http://www.packtpub.com/authors)。

# 客户支持

现在，你已经自豪地拥有了一本书，我们有一些东西可以帮助你从购买中获得最大的好处。

## 示例代码下载

您可以从您的帐户[http://www.packtpub.com](http://www.packtpub.com)下载您购买的所有 Packt Publishing 图书的示例代码文件。 如果您在其他地方购买这本书，您可以访问[http://www.packtpub.com/support](http://www.packtpub.com/support)并注册，将文件直接通过电子邮件发送给您。

## 勘误表

尽管我们已经竭尽全力确保内容的准确性，但错误还是会发生。 如果你在我们的书中发现错误，也许是文本或代码上的错误，如果你能向我们报告，我们将不胜感激。 通过这样做，您可以使其他读者免受挫折，并帮助我们改进这本书的后续版本。 如果您发现任何勘误表，请访问[http://www.packtpub.com/submit-errata](http://www.packtpub.com/submit-errata)，选择您的图书，点击**勘误表提交表格**链接，并输入您的勘误表详细信息。 一旦您的勘误表被核实，您的提交将被接受，勘误表将被上载到我们的网站或添加到该标题的勘误表部分下的任何现有勘误表列表中。

要查看之前提交的勘误表，请访问[https://www.packtpub.com/books/content/support](https://www.packtpub.com/books/content/support)并在搜索字段中输入书名。 所需资料将出现在**勘误表**部分。

## 盗版

在互联网上盗版受版权保护的材料是一个贯穿所有媒体的持续问题。 在 Packt，我们非常重视版权和授权的保护。 如果您在互联网上发现我们的作品以任何形式的非法拷贝，请立即提供我们的地址或网站名称，以便我们进行补救。

请通过`<[copyright@packtpub.com](mailto:copyright@packtpub.com)>`与我们联系，并提供疑似盗版资料的链接。

我们感谢您的帮助，保护我们的作者和我们的能力，为您带来有价值的内容。

## 问题

如果您对本书的任何方面有任何疑问，您可以通过`<[questions@packtpub.com](mailto:questions@packtpub.com)>`与我们联系，我们将尽力解决问题。